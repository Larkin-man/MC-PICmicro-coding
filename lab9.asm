#include<p16f84.inc>
 ORG 0
 GOTO BEGIN
 ORG 100h
BEGIN

 SCRATCH EQU 0Ch
 DIGIT EQU 0Dh
 REG EQU 0Eh

 BCF STATUS,RP0
 CLRF PORTB
 MOVLW B'00000000'
 BSF STATUS,RP0
 MOVWF TRISB

 BCF STATUS,RP0
 CLRF PORTA
 MOVLW B'11111'
 BSF STATUS,RP0
 MOVWF TRISA
 BCF STATUS,RP0

MAIN
 MOVF PORTA,0
 MOVWF SCRATCH
 MOVLW B'10000'
 XORWF SCRATCH,1    ;проверка кода
 BTFSC STATUS,Z
 GOTO TRUE          ;код верен
 GOTO FALSE         ;код не верен
 GOTO MAIN
 
TRUE
 MOVLW B'11111111'
 MOVWF PORTB
 GOTO MAIN

FALSE          ;бегущий огонёк
 MOVLW B'00000011'
 MOVWF PORTB
 MOVLW 07h
 MOVWF REG
LOOP
 CALL PAUSE
 BSF STATUS,0
 DECFSZ REG,1
 BCF STATUS,0
 RLF PORTB,1
 MOVLW 01h
 XORWF REG,0
 BTFSC STATUS,Z
 GOTO FALSE
 GOTO LOOP

PAUSE
 MOVLW D'255'
 MOVWF DIGIT
ONE
 MOVLW D'255'
 MOVWF SCRATCH
TWO
 DECFSZ SCRATCH,1
 GOTO TWO
 DECFSZ DIGIT,1
 GOTO ONE
 RETURN

 END
