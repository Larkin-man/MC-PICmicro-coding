#include<p16f84.inc>
 ORG 0
 GOTO BEGIN
 ORG 100h
BEGIN

SCRATCH EQU 0Ch
DIGIT EQU 0Dh
PORTAL EQU 0Eh

 BCF STATUS,RP0
 CLRF PORTB
 MOVLW B'00000000'
 BSF STATUS,RP0
 MOVWF TRISB
 BCF STATUS,RP0
 
 BCF STATUS,RP0
 CLRF PORTA
 MOVLW B'11111'
 BSF STATUS,RP0
 MOVWF TRISA
 BCF STATUS,RP0

 MOVLW B'00001001'
 MOVWF PORTAL
LOOP
 
 BTFSC PORTAL,0
 CALL FROT

 BTFSC PORTAL,1
 CALL FAR
 BTFSS PORTAL,1
 CALL UNFAR

 BTFSC PORTAL,2
 CALL GAB
 BTFSS PORTAL,2
 CALL UNGAB

 BTFSC PORTAL,3
 CALL SROT

 BTFSC PORTAL,4
 GOTO AVA
RETPOINT

 GOTO LOOP

FAR
 BSF PORTB,1
 BSF PORTB,2
 BSF PORTB,5
 BSF PORTB,6
 RETURN

UNFAR
 BCF PORTB,1
 BCF PORTB,2
 BCF PORTB,5
 BCF PORTB,6
 RETURN

GAB
 BSF PORTB,3
 BSF PORTB,4
 RETURN

UNGAB
 BCF PORTB,3
 BCF PORTB,4
 RETURN

FROT
 BTFSC PORTAL,3
 GOTO ERR
 BSF PORTB,0
 CALL PAUSE
 BCF PORTB,0
 CALL PAUSE
 RETURN

SROT
 BTFSC PORTAL,0
 GOTO ERR
 BSF PORTB,7
 CALL PAUSE
 BCF PORTB,7
 CALL PAUSE
 RETURN

AVA
 BTFSC PORTAL,0
 GOTO ERR
 BTFSC PORTAL,3
 GOTO ERR
 BSF PORTB,0
 BSF PORTB,7
 CALL PAUSE
 BCF PORTB,0
 BCF PORTB,7
 CALL PAUSE
 GOTO RETPOINT

PAUSE
 MOVLW D'255'
 MOVWF DIGIT
LOOP1
 MOVLW D'255'
 MOVWF SCRATCH
LOOP2
 DECFSZ SCRATCH,1
 ;GOTO LOOP2
 DECFSZ DIGIT,1
 ;GOTO LOOP1
 RETURN

ERR
 MOVLW B'11111111'
 MOVWF PORTB
 CALL PAUSE
 CLRF PORTB
 CALL PAUSE
 GOTO LOOP

 END
